import{q as ee,r as o,j as e,C as se,a as h,I as T,m as c,t as D}from"./app-CD6cBdKM.js";import{a as ae,D as oe}from"./layout-LS66cEvD.js";import{C as ne,a as F}from"./Can-C76XOY1w.js";import{D as P,a as I,b as L,C as re}from"./confirm-dialog-CDC-gDHT.js";import{u as le}from"./useLang-BvyXRUe-.js";import{p as te}from"./settings-button-CCgOCwZr.js";import{R as N,a as g}from"./rights-Bhv2ANV4.js";import{u as ie}from"./authz-DzcDTZqa.js";import{B as l}from"./Button--KfC8rp5.js";import{C as ce}from"./Card-4eiaUBLO.js";import{S as B}from"./Stack-vomvaMcO.js";import{T as M}from"./TextField-Dh4fcTDh.js";import{I as de}from"./InputAdornment-Bwj7yPg5.js";import{T as me,a as pe,b as he,c as w,d as n,e as ue}from"./TableHead-BPx6i0SZ.js";import{T as xe}from"./TablePagination-n4U631vZ.js";import{D as v}from"./Dialog-CFRChwGj.js";import{G as ge}from"./Grid-KnF3kKah.js";import{F as je}from"./FormControlLabel-DrSLr8OZ.js";import{C as fe}from"./Checkbox-BMTKf5nZ.js";import"./styles-gzNUAspH.js";import"./Popover-6bJkE66t.js";import"./createSvgIcon-BRtoGIw2.js";import"./useThemeProps-DzpMU5fq.js";import"./MenuItem-DmaGw-zu.js";import"./route-qstKo99j.js";import"./Tabs-CQmf7GIT.js";import"./merge-y9PmGEhP.js";import"./Link-DxKSdxqo.js";const Ce={title:`Roles | Dashboard - ${se.appName}`};function Ke({roles:j,permissions:z}){const{__:a}=le(),{props:G}=ee(),f=G.csrf_token,{can:y}=ie(),q=y("ROLES_EDIT"),H=y("ROLES_DELETE"),[A,V]=o.useState(j),[u,C]=o.useState(0),[d,$]=o.useState(5),[b,J]=o.useState(""),[K,x]=o.useState(!1),[_,O]=o.useState(""),[S,E]=o.useState(null),[t,k]=o.useState(null),[r,m]=o.useState(null);o.useEffect(()=>{V(j)},[j]);const R=o.useMemo(()=>A.filter(s=>s.name.toLowerCase().includes(b.toLowerCase())),[A,b]),W=o.useMemo(()=>R.slice(u*d,u*d+d),[R,u,d]),Q=(s,i)=>{C(i)},U=s=>{$(parseInt(s.target.value,10)),C(0)},X=()=>{c.post(route("roles.store"),{name:_,_token:f},{onSuccess:()=>{D.success(a("pages/roles.add_role")),x(!1),O(""),c.reload({only:["roles"]})}})},Y=()=>{S!==null&&c.delete(route("roles.destroy",S),{data:{_token:f},onSuccess:()=>{D.success(a("pages/roles.delete_success")),E(null),c.reload({only:["roles"]})}})};return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:Ce.title}),e.jsx(ae,{children:e.jsxs(oe,{maxWidth:"xl",children:[e.jsx(ne,{heading:a("pages/roles.breadcrumbs.roles"),links:[{name:a("pages/roles.breadcrumbs.dashboard"),href:te.dashboard.root},{name:a("pages/roles.breadcrumbs.roles")}],action:e.jsx(F,{permission:"ROLES_CREATE",children:e.jsx(l,{variant:"contained",startIcon:e.jsx(h,{icon:"mingcute:add-line"}),onClick:()=>x(!0),children:a("pages/roles.add_role")})}),sx:{mb:{xs:3,md:5}}}),e.jsxs(ce,{children:[e.jsx(B,{spacing:2,direction:{xs:"column",sm:"row"},sx:{p:2},children:e.jsx(M,{size:"small",value:b,onChange:s=>{J(s.target.value),C(0)},placeholder:a("pages/roles.search"),InputProps:{startAdornment:e.jsx(de,{position:"start",children:e.jsx(h,{icon:"solar:magnifer-linear",width:24})})}})}),e.jsx(me,{children:e.jsxs(pe,{children:[e.jsx(he,{children:e.jsxs(w,{children:[e.jsx(n,{children:a("pages/roles.table.name")}),e.jsx(n,{children:a("pages/roles.table.display")}),e.jsx(n,{children:a("pages/roles.table.created")}),e.jsx(n,{})]})}),e.jsxs(ue,{children:[W.map(s=>e.jsxs(w,{hover:!0,children:[e.jsx(n,{children:s.name}),e.jsx(n,{children:N[s.name]?a(N[s.name]):s.name}),e.jsx(n,{children:s.created_at}),e.jsxs(n,{align:"right",children:[e.jsx(T,{color:"primary",onClick:()=>k(s),children:e.jsx(h,{icon:"solar:eye-bold"})}),q&&e.jsx(T,{color:"warning",onClick:()=>m({id:s.id,permissions:s.permissions.map(i=>i.id)}),children:e.jsx(h,{icon:"solar:pen-bold"})}),H&&e.jsx(T,{color:"error",onClick:()=>E(s.id),children:e.jsx(h,{icon:"solar:trash-bin-trash-bold"})})]})]},s.id)),W.length===0&&e.jsx(w,{children:e.jsx(n,{colSpan:4,align:"center",children:a("pages/roles.no_data")})})]})]})}),e.jsx(xe,{component:"div",count:R.length,page:u,onPageChange:Q,rowsPerPage:d,onRowsPerPageChange:U,rowsPerPageOptions:[5,10,25]})]})]})}),e.jsx(F,{permission:"ROLES_CREATE",children:e.jsxs(v,{open:K,onClose:()=>x(!1),fullWidth:!0,maxWidth:"xs",children:[e.jsx(P,{children:a("pages/roles.add_role")}),e.jsx(I,{children:e.jsx(M,{autoFocus:!0,margin:"dense",label:a("pages/roles.add_role_placeholder"),size:"small",fullWidth:!0,variant:"filled",value:_,onChange:s=>O(s.target.value)})}),e.jsxs(L,{children:[e.jsx(l,{onClick:()=>x(!1),children:a("pages/roles.cancel")}),e.jsx(l,{variant:"contained",onClick:X,disabled:!_,children:a("pages/roles.add_role")})]})]})}),e.jsxs(v,{open:t!==null,onClose:()=>k(null),fullWidth:!0,maxWidth:"sm",children:[e.jsx(P,{children:a("pages/roles.permissions")}),e.jsx(I,{children:e.jsxs(B,{spacing:1,sx:{mt:1},children:[t==null?void 0:t.permissions.map(s=>e.jsx("div",{children:g[s.name]?a(g[s.name]):s.name},s.id)),t&&t.permissions.length===0&&e.jsx("div",{children:a("pages/roles.no_permissions")})]})}),e.jsx(L,{children:e.jsx(l,{onClick:()=>k(null),children:a("pages/roles.cancel")})})]}),e.jsxs(v,{open:r!==null,onClose:()=>m(null),fullWidth:!0,maxWidth:"sm",children:[e.jsx(P,{children:a("pages/roles.permissions")}),e.jsx(I,{children:e.jsx(ge,{container:!0,spacing:1,sx:{mt:1},children:z.map(s=>{const i=(r==null?void 0:r.permissions.includes(s.id))??!1;return e.jsx(je,{control:e.jsx(fe,{checked:i,onChange:()=>m(p=>p&&{...p,permissions:i?p.permissions.filter(Z=>Z!==s.id):[...p.permissions,s.id]})}),label:g[s.name]?a(g[s.name]):s.name})})})}),e.jsxs(L,{children:[e.jsx(l,{onClick:()=>m(null),children:a("pages/roles.cancel")}),e.jsx(l,{variant:"contained",onClick:()=>{r&&c.patch(route("roles.update",r.id),{permissions:r.permissions,_token:f},{onSuccess:()=>{D.success(a("pages/roles.permissions")),m(null),c.reload({only:["roles"]})}})},children:a("pages/roles.save")})]})]}),e.jsx(re,{open:S!==null,onClose:()=>E(null),title:a("pages/roles.delete_role"),content:a("pages/roles.delete_confirm"),action:e.jsx(l,{color:"error",variant:"contained",onClick:Y,children:a("pages/roles.delete")})})]})}export{Ke as default};
