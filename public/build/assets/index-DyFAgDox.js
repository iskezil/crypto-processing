import{E,q as A,m as p,t as d,j as e,B,T as q,I as c,a as u}from"./app-CD6cBdKM.js";import{o as O,b as P,e as z,u as M,a as D,s as i,i as G,n as L,c as U,g as R,F as V,d as t}from"./form-provider-C9b8JaXX.js";import"./styles-gzNUAspH.js";import"./order-complete-illustration-KAH1HJrN.js";import{u as $}from"./useLang-BvyXRUe-.js";import{r as x}from"./route-qstKo99j.js";import{G as l}from"./Grid-KnF3kKah.js";import{C as f}from"./Card-4eiaUBLO.js";import{S as g}from"./Stack-vomvaMcO.js";import{I as v}from"./InputAdornment-Bwj7yPg5.js";import{M as b}from"./MenuItem-DmaGw-zu.js";import{B as H}from"./Button--KfC8rp5.js";import"./TextField-Dh4fcTDh.js";import"./Popover-6bJkE66t.js";import"./createSvgIcon-BRtoGIw2.js";import"./FormControlLabel-DrSLr8OZ.js";import"./Chip-BNrhAUiE.js";import"./merge-y9PmGEhP.js";import"./Checkbox-BMTKf5nZ.js";import"./useThemeProps-DzpMU5fq.js";function ce({roles:h}){const{__:s}=$(),o=E(),{props:j}=A(),w=j.csrf_token,_=O({name:i().min(1,{message:s("validation.required",{attribute:s("validation.attributes.name")})}),email:i().email({message:s("validation.email",{attribute:s("validation.attributes.email")})}),password:i().min(6,{message:s("validation.min.string",{attribute:s("validation.attributes.password"),min:6})}),password_confirmation:i().min(1,{message:s("validation.required",{attribute:s("validation.attributes.password_confirmation")})}),roles:D(i()).min(1,{message:s("validation.required",{attribute:s("validation.attributes.roles")})}),avatar:M([G(File),i(),L()]).nullable(),status:z(["active","pending"]),email_verified:P()}).refine(a=>a.password===a.password_confirmation,{path:["password_confirmation"],message:s("validation.confirmed")}),m=U({resolver:R(_),mode:"onChange",defaultValues:{name:"",email:"",password:"",password_confirmation:"",roles:[],avatar:null,status:"active",email_verified:!1}}),{handleSubmit:y,setError:T,formState:{isSubmitting:S}}=m,k=h.map(a=>({label:s(`pages/users.roles.${a.name.toLowerCase()}`),value:String(a.id)})),F=y(a=>{const r=new FormData;r.append("_token",w),r.append("name",a.name),r.append("email",a.email),r.append("password",a.password),r.append("password_confirmation",a.password_confirmation),a.roles.forEach(n=>r.append("roles[]",n)),r.append("status",a.status),r.append("email_verified_at",a.email_verified?new Date().toISOString():""),a.avatar instanceof File&&r.append("avatar",a.avatar),p.post(x("users.store"),r,{onSuccess:()=>{d.success(s("pages/users.create_success")),p.visit(x("users.index"))},onError:n=>{Object.entries(n).forEach(([I,C])=>{T(I,{type:"server",message:C})}),d.error(s("pages/users.create_error"))}})});return e.jsx(V,{methods:m,onSubmit:F,children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{size:{xs:12,md:4},children:e.jsx(f,{sx:{p:3},children:e.jsxs(g,{spacing:3,alignItems:"center",children:[e.jsx(B,{sx:{mb:5},children:e.jsx(t.UploadAvatar,{name:"avatar",accept:{"image/jpeg":[],"image/png":[],"image/gif":[]},maxSize:3145728,helperText:e.jsx(q,{variant:"caption",color:"text.secondary",sx:{mt:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:s("pages/users.form.avatar_helper")})})}),e.jsx(t.Switch,{name:"email_verified",label:s("pages/users.form.email_verified"),helperText:s("pages/users.form.email_verified_caption"),slotProps:{wrapper:{sx:{width:1}},helperText:{sx:{textAlign:"left"}}}})]})})}),e.jsx(l,{size:{xs:12,md:8},children:e.jsx(f,{sx:{p:3},children:e.jsxs(g,{spacing:3,children:[e.jsx(t.Text,{name:"name",label:s("pages/users.form.name")}),e.jsx(t.Text,{name:"email",label:s("pages/users.form.email")}),e.jsx(t.Text,{name:"password",type:o.value?"text":"password",label:s("pages/users.form.password"),slotProps:{input:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(c,{onClick:o.onToggle,edge:"end",children:e.jsx(u,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}}),e.jsx(t.Text,{name:"password_confirmation",type:o.value?"text":"password",label:s("validation.attributes.password_confirmation"),slotProps:{input:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(c,{onClick:o.onToggle,edge:"end",children:e.jsx(u,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}}),e.jsx(t.MultiSelect,{name:"roles",label:s("pages/users.form.roles"),options:k,placeholder:"",checkbox:!0}),e.jsxs(t.Select,{name:"status",label:s("pages/users.form.status"),children:[e.jsx(b,{value:"active",children:s("pages/users.statuses.active")}),e.jsx(b,{value:"pending",children:s("pages/users.statuses.pending")})]}),e.jsx(H,{type:"submit",variant:"contained",loading:S,sx:{ml:"auto"},children:s("pages/users.form.submit_create")})]})})})]})})}export{ce as CreateUserForm};
